#| label: fig-topspend
#| fig-cap: "Top Medication Spending from 2019 - 2022 across Medicare Part B, D and Medicaid"
#| warning: false
#| echo: false
library(tidyverse)
med_spend_dose_trim = readRDS("data/top_med_spend.rds")
g1 = med_spend_dose_trim%>%
filter(Doses_All>10000000)%>%
ggplot(aes(x=Doses_All, y=Spending_All))+
geom_point(aes(size=size_bucket), alpha=.7)+
geom_text_repel(data = head(med_spend_dose_trim, 10), aes(label=Generic),
nudge_x = 0.1, nudge_y = 0.2, show.legend = FALSE)+
scale_x_log10(labels = scales::label_number(scale = 1e-6, suffix = "M", big.mark = ","))+
scale_y_continuous(labels = scales::label_dollar(scale = 1e-6, suffix = "M"))+
scale_size_manual(values = c("<50M"=2, "50–150M"=4, "150–300M"=6, ">300M"=8))+
labs(title = "Medicare Part B, D & Medicaid Drug Spending",
subtitle = "2019 - 2022",
x="Doses Prescribed (Millions)",
y="Total Spending (Millions)",
size="Claims",
caption="Limited to medications with at least 10 million doses"
)+
theme_minimal(base_size = 10)
print(g1)
#| label: fig-topspend
#| fig-cap: "Top Medication Spending from 2019 - 2022 across Medicare Part B, D and Medicaid"
#| warning: false
#| echo: false
library(tidyverse)
library(ggrepel)
med_spend_dose_trim = readRDS("data/top_med_spend.rds")
g1 = med_spend_dose_trim%>%
filter(Doses_All>10000000)%>%
ggplot(aes(x=Doses_All, y=Spending_All))+
geom_point(aes(size=size_bucket), alpha=.7)+
geom_text_repel(data = head(med_spend_dose_trim, 10), aes(label=Generic),
nudge_x = 0.1, nudge_y = 0.2, show.legend = FALSE)+
scale_x_log10(labels = scales::label_number(scale = 1e-6, suffix = "M", big.mark = ","))+
scale_y_continuous(labels = scales::label_dollar(scale = 1e-6, suffix = "M"))+
scale_size_manual(values = c("<50M"=2, "50–150M"=4, "150–300M"=6, ">300M"=8))+
labs(title = "Medicare Part B, D & Medicaid Drug Spending",
subtitle = "2019 - 2022",
x="Doses Prescribed (Millions)",
y="Total Spending (Millions)",
size="Claims",
caption="Limited to medications with at least 10 million doses"
)+
theme_minimal(base_size = 10)
print(g1)
library(gt)
gt(data = head(mtcars)) %>%
tab_header(
title = "Motor Trend Car Road Tests",
subtitle = "A subset of the mtcars dataset"
)
library(knitr)
library(kableExtra)
kable(head(mtcars), format = "html") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
install.packages("gt")
library(gt)
gt(data = head(mtcars)) %>%
tab_header(
title = "Motor Trend Car Road Tests",
subtitle = "A subset of the mtcars dataset"
)
#| label: fig-h1
#| fig-cap: "Hypothesis 1 - Comparing GLP-1 receptor agonists, primarily used for type 2 diabetes management"
#| warning: false
#| echo: false
library(tidyverse)
h_df_clean = readRDS("data/h_df_clean.rds")
h_df_clean%>%
filter(drug_name_clean %in% c("Dulaglutide", "Semaglutide"))%>%
ggplot(aes(x = median_price, fill = white_95)) +
geom_density(alpha = 0.5) +
scale_fill_manual(values = c("blue", "orange"),
labels = c("<95% White", "≥95% White")) +
labs(
title = "Density Plots of Mean Drug Prices by County Demographics",
x = "Mean Price",
y = "Density",
fill = "County Group"
) +
facet_grid(.~ drug_name_clean, scales = "free") +
theme_minimal()
#| label: fig-h1
#| fig-cap: "Hypothesis 1 - Comparing GLP-1 receptor agonists, primarily used for type 2 diabetes management"
#| warning: false
#| echo: false
library(tidyverse)
h_df_clean = readRDS("data/h_df_clean.rds")
h_df_clean%>%
filter(drug_name_clean %in% c("Dulaglutide", "Semaglutide"))%>%
ggplot(aes(x = median_price, fill = white_95)) +
geom_density(alpha = 0.5) +
scale_fill_manual(values = c("blue", "orange"),
labels = c("<95% White", "≥95% White")) +
labs(
title = "Density Plots of Mean Drug Prices by County Demographics",
x = "Mean Price",
y = "Density",
fill = "County Group"
) +
facet_grid(.~ drug_name_clean, scales = "free") +
theme_minimal()
#| label: fig-h2
#| fig-cap: "Hypothesis 2 - Comparing six medications which were indicated for statistically significant differences in price for two poverty groups"
#| warning: false
#| echo: false
library(tidyverse)
h_df_clean = readRDS("data/h_df_clean.rds")
h_df_clean%>%
filter(drug_name_clean %in% c("Semaglutide", "Dulaglutide", "Ibrutinib", "Insulin Aspart",
"Adalimumab", "Etanercept"))%>%
ggplot(aes(x = mean_price, fill = poverty_13)) +
geom_density(alpha = 0.5) +
scale_fill_manual(values = c("blue", "orange"),
labels = c("<13% Below Poverty", "≥13% Below Poverty")) +
labs(
title = "Density Plots of Mean Drug Prices by County Demographics",
x = "Mean Price",
y = "Density",
fill = "County Group"
) +
facet_wrap(~ drug_name_clean, scales = "free") +
theme_minimal()
