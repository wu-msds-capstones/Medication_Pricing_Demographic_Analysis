[
  {
    "objectID": "capstone.html",
    "href": "capstone.html",
    "title": "Drug Pharmacy Costs Across US Demographics",
    "section": "",
    "text": "Escalating pharmaceutical prices in the U.S. are reshaping public health policy, widening healthcare disparities, and straining the financial well-being of millions. A recent KFF poll found that 60% of adults take at least one prescription, and 25% take four or more (“Public Opinion on Prescription Drugs and Their Prices” 2024). Yet, as pharmaceutical technology advances, affordability remains a significant concern. Even with coverage through Medicare, Medicaid, or private insurance, many patients face high out-of-pocket costs that contribute to financial stress and, in some cases, treatment avoidance.\nAccording to the Commonwealth Fund (“2025 Scorecard on State Health System Performance, Fragile Progress, Continuing Disparities” 2025), 30% of U.S. adults carry medical debt, and nearly 57% of underinsured adults delay or avoid necessary treatment due to cost. This financial strain is compounded by the fragmented structure of public insurance programs like Medicare and Medicaid, which serve only specific populations and vary widely by state and county. These regional differences in plan availability and coverage often translate into significant disparities in pricing and out-of-pocket costs, further undermining equitable access to care.\nWhile medications are only one aspect of medical care, they are essential in preventing more costly interventions. Chronic conditions such as diabetes, cardiovascular disease, and kidney disease can often be effectively managed with medication, reducing the need for hospitalization or surgery. A recent study by UNC Health (UNC Health 2025) found that oral semaglutide (marketed as Ozempic and Rybelsus for diabetes, and Wegovy for weight loss) significantly lowered the risk of heart attacks and strokes. This underscores that medication affordability is not merely a matter of convenience but a foundation of equitable, cost-effective healthcare.\nThis project examines the costs associated with Medicare prescription drug plans and their impact on different demographic groups across the U.S. By analyzing how plan pricing varies by state and county, we aim to better understand the financial burden on underserved populations. The findings will illuminate geographic and socioeconomic disparities in medication affordability and may inform policy changes or targeted interventions to advance health equity.\nTo support this analysis, we integrated publicly available data from the Centers for Medicare & Medicaid Services (CMS), the U.S. Census Bureau, and the Food and Drug Administration (FDA). These datasets provide detailed information on drug pricing, clinical use, demographic characteristics, and public insurance coverage specifically for Medicare patients (aka patients over the age of 65). We consolidated the data into a unified DuckDB instance hosted on AWS S3, enabling efficient, scalable querying across the large and diverse datasets. This infrastructure underpins a comprehensive analysis of pharmaceutical spending and supports demographically informed cost modeling."
  },
  {
    "objectID": "capstone.html#data-sources",
    "href": "capstone.html#data-sources",
    "title": "Drug Pharmacy Costs Across US Demographics",
    "section": "Data sources",
    "text": "Data sources\nFor data collection, our first focus was on collecting pricing information for different drugs tied to different geographic locations so we could easily pair those geographic locations with demographic census data.\nTo obtain medication pricing data, we initially explored several APIs from online pharmacies, including GoodRx (GoodRx 2025), which aim to improve consumer price transparency. However, these sources could not be reliably linked to the county-level demographic data essential to our analysis. Consequently, we turned to the Centers for Medicare & Medicaid Services (CMS), which offers one of the most comprehensive public datasets on healthcare coverage and drug pricing. CMS maintains over 100 datasets spanning prescription costs, plan structures, and beneficiary demographics (Centers for Medicare & Medicaid Services 2025).\nAmong the available CMS datasets, we selected the Quarterly Prescription Drug Plan Formulary as our primary source. Of particular interest were the pricing files, basic formulary files, plan information files, and the geographic locator file, which enabled us to map drug prices and plan availability at the county level across the U.S. A key limitation of this dataset is that it reflects only those covered under Medicare, which applies to a specific segment of the population. Medicare eligibility generally requires individuals to be age 65 or older, although those with disabilities, end-stage renal disease (ESRD), or amyotrophic lateral sclerosis (ALS) may qualify earlier (U.S. Department of Health & Human Services 2022). Despite this limitation, Medicare formulary data, specifically Part D coverage, can serve as a functional proxy for medication prices across the US. First, Medicare Part D covers over 50 million beneficiaries, which makes it one of the largest prescription drug programs in the US. Medicare contracts with private insurers who then negotiate prices with drug manufacturers and pharmacies, which can reflect real-world pricing. Medicare has tremendous leverage in the marketplace and is one of the largest purchasers of prescription drugs. Accordingly, this makes Medicare a substantial market influencer, which means that its pricing can set or anchor prices for the entire marketplace. We can reasonably infer that uninsured buyers, or buyers leveraging other forms of insurance, would pay at least as much as Medicare under Part D coverage.\nIn conclusion, the formulary dataset offered a rare combination of granularity and breadth, with plan- and region-specific pricing that could be meaningfully paired with demographic data. It was also readily accessible and downloadable in bulk, making it a practical and robust foundation for our analysis.\nThe demographic data selection was much simpler, and we quickly concluded that the US Census (U.S. Census Bureau 2025) would provide county-level demographic information, which we could connect to the medication pricing data after only a little data cleaning. Our team leveraged the Tidycensus (Walker and Herman 2025) package in R to ingest demographic data at the county level.\nDuring initial exploration, we found that the CMS datasets reference medications only by their National Drug Code (NDC), without corresponding drug names. To interpret these codes meaningfully, we integrated drug identification data from the FDA’s National Drug Code Directory (U.S. Food and Drug Administration 2025). Finally, we incorporated three additional datasets from CMS to assess overall drug spending at the national level. These datasets, covering the years 2019 through 2023, provided high-level insights into Medicare and Medicaid expenditures, including spending under Medicare Part D, Medicare Part B, and Medicaid. While this data lacked the geographic granularity needed for county-level analysis, it offered valuable context by identifying medications with the greatest national impact based on total cost. This broader perspective helped inform and prioritize our exploration of the formulary data. The national spending datasets included information on total spending, the number of beneficiaries, claims filed, and doses dispensed. This enabled us to assess patterns such as high-cost, low-frequency medications versus low-cost, high-frequency ones. Integrating this information into our broader database enhanced analytical flexibility and supported a more comprehensive understanding of pharmaceutical spending across programs."
  },
  {
    "objectID": "capstone.html#data-cleaning",
    "href": "capstone.html#data-cleaning",
    "title": "Drug Pharmacy Costs Across US Demographics",
    "section": "Data cleaning",
    "text": "Data cleaning\nAlthough the previous section may suggest that combining and storing the data was straightforward, the data cleaning and processing phase presented a significant challenge, consistent with the complexities typical of most data science projects. Below, we outline several key issues encountered during this stage.\nThe CMS Quarterly Prescription Drug Plan Formulary datasets were significantly larger than those our team had previously worked with. Each quarterly file from 2019 Q1 through 2025 Q1 contained approximately 10–12 GB of compressed data. To manage scope, we narrowed our focus to the 2023 Q4 dataset. Even within this single quarter, the formulary included pricing data for approximately 6,336 unique medications (identified by NDC codes), across multiple dosage strengths and 30-, 60-, and 90-day supply options. These were distributed across 5,644 unique contract/plan combinations. Some Medicare plan options were listed at the county level, while others were available only at the broader regional level, either as Medicare Advantage (MA, also known as Part C) or Prescription Drug Plans (PDP). To align these regional plans with our census-based demographic data, we disaggregated them by county. Medication prices varied not only by NDC code, but also by supply duration, dosage strength (e.g., 10 mg, 30 mg, 50 mg daily), delivery mechanism (e.g., pill, patch, injection, liquid), and Medicare plan.\nA major limitation of the CMS formulary data was the absence of medication names; it included only 11-digit National Drug Code (NDC) identifiers. In contrast, the overall spending dataset listed drug names but did not include NDC codes, making it impossible to directly join the two datasets without an intermediary reference. Because NDC codes are not interpretable to non-experts, converting them to medication names was essential for meaningful analysis and presentation.\nTo resolve this, we turned to the FDA’s National Drug Code Directory (U.S. Food and Drug Administration 2025), which provides comprehensive drug identification data. However, we encountered a formatting mismatch: the NDC codes in the FDA dataset included dashes and excluded leading zeros, resulting in codes shorter than the 11-digit format used by CMS. The NDC structure consists of three segments (labeler (5 digits), product (4 digits), and package (2 digits)), but the FDA format often compresses these fields, creating inconsistencies once the dashes are removed. To reconcile this, we standardized both datasets to a 9-digit format by removing the package-level detail and padding or trimming segments as needed. After extensive data cleaning and formatting, we successfully linked the FDA drug names to the CMS formulary data, enabling consistent identification and analysis across datasets.\nFortunately, the naming conventions utilized by CMS in their overall spending data were largely consistent with the naming conventions provided by the FDA (95% match), which allowed for the overall spending files to be related in the database to individual medication prices by county and Medicare plan. The project now had compelling connections across a massive number of very large data files.\nDuring the geographic analysis, we identified a unique complication related to Connecticut. In 2022, all Connecticut counties were renamed and had their boundaries redrawn (Federal Register: The Daily Journal of the United States Government 2022). While our primary focus was on Q4 2023 data, a discrepancy emerged: CMS data continued to use the pre-2022 county names and boundaries, whereas the U.S. Census Bureau adopted the updated designations. Because the county shapes also changed, we applied engineering judgment to map the old county definitions to the new ones. As a result, any county-level analysis for Connecticut should be interpreted as an approximation. Data for all other U.S. counties remains accurate once spellings were matched."
  },
  {
    "objectID": "capstone.html#scope-of-analysis",
    "href": "capstone.html#scope-of-analysis",
    "title": "Drug Pharmacy Costs Across US Demographics",
    "section": "Scope of Analysis:",
    "text": "Scope of Analysis:\nOne of the first goals was to understand the connected data at a high level by condensing and aggregating details. Due to the granularity of the formulary data, it was necessary to narrow the focus rather than analyze all 6,000+ medications. The CMS spending datasets (Part B, Part D, and Medicaid) provided a clearer, structured view and helped identify high-impact drugs. Using this data, we generated top drug lists by total spend, claims, and doses (?@fig-topspend), ultimately selecting a few key medications for deeper analysis.\nTRAVIS TO UPDATE THIS PLOT WITH CODE\n For the rest of the analysis, we plan to use these top drugs by the most absolute spend in 2019-2023. To help contextualize what conditions these medications treat, see the table below. See Table 1\n\n\n\nTable 1: Table 1 - Top medications by absolute spend and the treatment conditions\n\n\n\n\n\n\n\n\n\n\n\nTotal Spend (USD)\nGeneric Name\nBrand Name(s)\nCommon Treatment Conditions\n\n\n\n\n$67.3B\nApixaban\nEliquis\nAFib (Atrial Fibrillation), DVT/PE (Deep Vein Thrombosis / Pulmonary Embolism), Post-surgery Prophylaxis\n\n\n$43.1B\nAdalimumab\nHumira, Biosimilars\nchronic inflammatory or autoimmune conditions such as RA (Rheumatoid Arthritis), PsA (Psoriatic Arthritis), AS (Ankylosing Spondylitis), CD (Crohn’s Disease), UC (Ulcerative Colitis), Psoriasis, JIA (Juvenile Idiopathic Arthritis), uveitis\n\n\n$30.9B\nDulaglutide\nTrulicity\nType 2 Diabetes\n\n\n$29.9B\nLenalidomide\nRevlimid\nMultiple Myeloma, MDS (Myelodysplastic Syndromes)\n\n\n$28.4B\nRivaroxaban\nXarelto\nAFib (Atrial Fibrillation), DVT/PE (Deep Vein Thrombosis / Pulmonary Embolism)\n\n\n$26.9B\nEmpagliflozin\nJardiance\nType 2 Diabetes, CV risk\n\n\n$26.7B\nSemaglutide\nOzempic, Wegovy\nType 2 diabetes, Obesity\n\n\n$18.4B\nPaliperidone Palmitate\nInvega Sustenna/Trinza\nSchizophrenia\n\n\n$16.7B\nEtanercept\nEnbrel\nRA (Rheumatoid Arthritis), PsA (Psoriatic Arthritis), AS (Ankylosing Spondylitis), Psoriasis\n\n\n$15.7B\nInsulin Aspart\nNovolog, Fiasp\nType 1 & 2 Diabetes\n\n\n$15.2B\nUstekinumab\nStelara\nPsoriasis, PsA (Psoriatic Arthritis), Crohns\n\n\n$14.5B\nIbrutinib\nImbruvica\nblood cancers such as CLL (Chronic Lymphocytic Leukemia), MCL (Mantle Cell Lymphoma), and WM (Waldenström’s Macroglobulinemia)\n\n\n$12.1B\nTiotropium Bromide\nSpiriva\nCOPD (Chronic Obstructive Pulmonary Disease), Asthma (adjunct)\n\n\n$11.6B\nLiraglutide\nVictoza, Saxenda\nType 2 Diabetes, Obesity"
  },
  {
    "objectID": "capstone.html#overview-of-analysis",
    "href": "capstone.html#overview-of-analysis",
    "title": "Drug Pharmacy Costs Across US Demographics",
    "section": "Overview of Analysis:",
    "text": "Overview of Analysis:\nAfte mapping individual medication prices to counties across the U.S. by way of which Medicare plans were available in each county, we discovered that drugs can have a lot more variance in pricing than we even imagined. The most variable drug had over 6k unique prices across the country, with many in the 4k range. To statistically simplify, we took the median across all 30-day supply prices for each drug (9-digit NDC code) within each county. Note: 60-day and 90-day prices were also available, but were filtered out to simplify the overall analysis. A box plot of the top medications by total spend are shown below descending from the most spend to the least spend. {Figure 1} This shows the variance in drug prices. Note that the absolute cost of the medication doesn’t correlate with the total nationwide spend for that medication. The drug with the top overall spend (Apixaban) is one of the cheapest at ~$10 per 30-day supply, while another drug in the top overall spend is VERY expensive at ~$26k per 30-day supply.\n\n\n\n\n\n\n\n\nFigure 1: Variance in price amongst the top drugs /n (descending by absolute spending) across the US\n\n\n\n\n\nNot all these prices are available to every Medicare patient in the US. An individual’s price options depend on their county of residence. To further showcase the variance at a county level, below is a bar chart showing the number of medicare plans available within a sample state by county. (Figure 2)\n\n\n\n\n\n\n\n\nFigure 2: Unique Medicare Plan Counts by Oregon County"
  }
]